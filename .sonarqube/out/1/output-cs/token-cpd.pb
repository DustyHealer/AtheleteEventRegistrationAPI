˜P
nC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Controllers\AthleteController.cs
	namespace 	

AthleteAPI
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
AthleteController "
:# $
ControllerBase% 3
{ 
private 
readonly 
IAthleteService (
service) 0
;0 1
public 
AthleteController  
(  !
IAthleteService! 0
_service1 9
)9 :
{ 	
service 
= 
_service 
; 
} 	
[ 	
HttpGet	 
( 
$str :
): ;
]; <
[ 	
	Authorize	 
( 
Roles 
= 
$str '
)' (
]( )
public 
IActionResult 
GetAllAthletes +
(+ ,
int, /"
excludeLoggedInAthlete0 F
)F G
{ 	
try 
{ 
return 
Ok 
( 
service !
.! "
GetAllAthletes" 0
(0 1"
excludeLoggedInAthlete1 G
)G H
)H I
;I J
} 
catch   
(   
	Exception   
e   
)   
{!! 
return"" 

BadRequest"" !
(""! "
e""" #
.""# $
Message""$ +
)""+ ,
;"", -
}## 
}$$ 	
[&& 	
HttpGet&&	 
(&& 
$str&& !
)&&! "
]&&" #
['' 	
	Authorize''	 
('' 
Roles'' 
='' 
$str'' '
)''' (
]''( )
public(( 
IActionResult(( 
GetAllAthletes(( +
(((+ ,
)((, -
{)) 	
try** 
{++ 
return,, 
Ok,, 
(,, 
service,, !
.,,! "
GetAllAthletes,," 0
(,,0 1
),,1 2
),,2 3
;,,3 4
}-- 
catch.. 
(.. 
	Exception.. 
e.. 
).. 
{// 
return00 

BadRequest00 !
(00! "
e00" #
.00# $
Message00$ +
)00+ ,
;00, -
}11 
}22 	
[44 	
HttpGet44	 
(44 
$str44 *
)44* +
]44+ ,
[55 	
	Authorize55	 
(55 
Roles55 
=55 
$str55 "
)55" #
]55# $
public66 
IActionResult66 #
GetAllUnblockedAthletes66 4
(664 5
)665 6
{77 	
try88 
{99 
return:: 
Ok:: 
(:: 
service:: !
.::! "#
GetAllUnblockedAthletes::" 9
(::9 :
)::: ;
)::; <
;::< =
};; 
catch<< 
(<< 
	Exception<< 
e<< 
)<< 
{== 
return>> 

BadRequest>> !
(>>! "
e>>" #
.>># $
Message>>$ +
)>>+ ,
;>>, -
}?? 
}@@ 	
[BB 	
HttpGetBB	 
(BB 
$strBB #
)BB# $
]BB$ %
[CC 	
	AuthorizeCC	 
(CC 
RolesCC 
=CC 
$strCC '
)CC' (
]CC( )
publicDD 
IActionResultDD 
GetAllCategoriesDD -
(DD- .
)DD. /
{EE 	
tryFF 
{GG 
returnHH 
OkHH 
(HH 
serviceHH !
.HH! "
GetAllCategoriesHH" 2
(HH2 3
)HH3 4
)HH4 5
;HH5 6
}II 
catchJJ 
(JJ 
	ExceptionJJ 
eJJ 
)JJ 
{KK 
returnLL 

BadRequestLL !
(LL! "
eLL" #
.LL# $
MessageLL$ +
)LL+ ,
;LL, -
}MM 
}NN 	
[PP 	
HttpGetPP	 
(PP 
$strPP *
)PP* +
]PP+ ,
[QQ 	
	AuthorizeQQ	 
(QQ 
RolesQQ 
=QQ 
$strQQ '
)QQ' (
]QQ( )
publicRR 
IActionResultRR 
GetAthleteByIdRR +
(RR+ ,
intRR, /
idRR0 2
)RR2 3
{SS 	
tryTT 
{UU 
returnVV 
OkVV 
(VV 
serviceVV !
.VV! "
GetAthleteByIdVV" 0
(VV0 1
idVV1 3
)VV3 4
)VV4 5
;VV5 6
}WW 
catchXX 
(XX $
AthleteNotFoundExceptionXX +
eXX, -
)XX- .
{YY 
returnZZ 
NotFoundZZ 
(ZZ  
eZZ  !
.ZZ! "
MessageZZ" )
)ZZ) *
;ZZ* +
}[[ 
catch\\ 
(\\ 
	Exception\\ 
e\\ 
)\\ 
{]] 
return^^ 

BadRequest^^ !
(^^! "
e^^" #
.^^# $
Message^^$ +
)^^+ ,
;^^, -
}__ 
}`` 	
[bb 	
HttpGetbb	 
(bb 
$strbb *
)bb* +
]bb+ ,
[cc 	
	Authorizecc	 
(cc 
Rolescc 
=cc 
$strcc '
)cc' (
]cc( )
publicdd 
IActionResultdd 
GetAthleteByNamedd -
(dd- .
stringdd. 4
namedd5 9
)dd9 :
{ee 	
tryff 
{gg 
returnhh 
Okhh 
(hh 
servicehh !
.hh! "
GetAthleteByNamehh" 2
(hh2 3
namehh3 7
)hh7 8
)hh8 9
;hh9 :
}ii 
catchjj 
(jj $
AthleteNotFoundExceptionjj +
ejj, -
)jj- .
{kk 
returnll 
NotFoundll 
(ll  
ell  !
.ll! "
Messagell" )
)ll) *
;ll* +
}mm 
catchnn 
(nn 
	Exceptionnn 
enn 
)nn 
{oo 
returnpp 

BadRequestpp !
(pp! "
epp" #
.pp# $
Messagepp$ +
)pp+ ,
;pp, -
}qq 
}rr 	
[tt 	
HttpGettt	 
(tt 
$strtt 2
)tt2 3
]tt3 4
[uu 	
	Authorizeuu	 
(uu 
Rolesuu 
=uu 
$struu '
)uu' (
]uu( )
publicvv 
IActionResultvv  
GetAthleteByCategoryvv 1
(vv1 2
stringvv2 8
categoryvv9 A
)vvA B
{ww 	
tryxx 
{yy 
returnzz 
Okzz 
(zz 
servicezz !
.zz! " 
GetAthleteByCategoryzz" 6
(zz6 7
categoryzz7 ?
)zz? @
)zz@ A
;zzA B
}{{ 
catch|| 
(|| 
	Exception|| 
e|| 
)|| 
{}} 
return~~ 

BadRequest~~ !
(~~! "
e~~" #
.~~# $
Message~~$ +
)~~+ ,
;~~, -
} 
}
ÄÄ 	
[
ÇÇ 	
HttpPost
ÇÇ	 
(
ÇÇ 
$str
ÇÇ 
)
ÇÇ 
]
ÇÇ  
[
ÉÉ 	
	Authorize
ÉÉ	 
(
ÉÉ 
Roles
ÉÉ 
=
ÉÉ 
$str
ÉÉ "
)
ÉÉ" #
]
ÉÉ# $
public
ÑÑ 
IActionResult
ÑÑ 

AddAthlete
ÑÑ '
(
ÑÑ' (
Athlete
ÑÑ( /
athlete
ÑÑ0 7
)
ÑÑ7 8
{
ÖÖ 	
try
ÜÜ 
{
áá 
return
ââ 
Ok
ââ 
(
ââ 
service
ââ !
.
ââ! "

AddAthlete
ââ" ,
(
ââ, -
athlete
ââ- 4
)
ââ4 5
)
ââ5 6
;
ââ6 7
}
ää 
catch
ãã 
(
ãã +
AthleteAlreadyExistsException
ãã 0
e
ãã1 2
)
ãã2 3
{
åå 
return
çç 
Conflict
çç 
(
çç  
e
çç  !
.
çç! "
Message
çç" )
)
çç) *
;
çç* +
}
éé 
catch
èè 
(
èè 
	Exception
èè 
e
èè 
)
èè 
{
êê 
return
ëë 

BadRequest
ëë !
(
ëë! "
e
ëë" #
.
ëë# $
Message
ëë$ +
)
ëë+ ,
;
ëë, -
}
íí 
}
ìì 	
[
ïï 	
HttpPut
ïï	 
(
ïï 
$str
ïï 5
)
ïï5 6
]
ïï6 7
[
ññ 	
	Authorize
ññ	 
(
ññ 
Roles
ññ 
=
ññ 
$str
ññ "
)
ññ" #
]
ññ# $
public
óó 
IActionResult
óó 
BlockAthleteById
óó -
(
óó- .
int
óó. 1
id
óó2 4
,
óó4 5
string
óó6 <
status
óó= C
)
óóC D
{
òò 	
try
ôô 
{
öö 
return
õõ 
Ok
õõ 
(
õõ 
service
õõ !
.
õõ! "
BlockAthleteById
õõ" 2
(
õõ2 3
id
õõ3 5
,
õõ5 6
status
õõ7 =
)
õõ= >
)
õõ> ?
;
õõ? @
}
úú 
catch
ùù 
(
ùù &
AthleteNotFoundException
ùù +
e
ùù, -
)
ùù- .
{
ûû 
return
üü 
NotFound
üü 
(
üü  
e
üü  !
.
üü! "
Message
üü" )
)
üü) *
;
üü* +
}
†† 
catch
°° 
(
°° 
	Exception
°° 
e
°° 
)
°° 
{
¢¢ 
return
££ 

BadRequest
££ !
(
££! "
e
££" #
.
££# $
Message
££$ +
)
££+ ,
;
££, -
}
§§ 
}
•• 	
}
¶¶ 
}ßß ˜
yC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Exceptions\AthleteAlreadyExistsException.cs
	namespace 	

AthleteAPI
 
. 

Exceptions 
{ 
public 

class )
AthleteAlreadyExistsException .
:/ 0
	Exception1 :
{		 
public

 )
AthleteAlreadyExistsException

 ,
(

, -
string

- 3
message

4 ;
)

; <
:

= >
base

? C
(

C D
message

D K
)

K L
{ 	
} 	
} 
} Ë
tC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Exceptions\AthleteNotFoundException.cs
	namespace 	

AthleteAPI
 
. 

Exceptions 
{ 
public 

class $
AthleteNotFoundException )
:* +
	Exception, 5
{		 
public

 $
AthleteNotFoundException

 '
(

' (
string

( .
message

/ 6
)

6 7
:

8 9
base

: >
(

> ?
message

? F
)

F G
{ 	
} 	
} 
} ˛
_C:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Models\Athlete.cs
	namespace 	

AthleteAPI
 
. 
Models 
{		 
public

 

class

 
Athlete

 
{ 
[ 	
Key	 
] 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
None3 7
)7 8
]8 9
public 
int 
	AthleteId 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Height 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Weight 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
City 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Country 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Category 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
ImageURL 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
$str- 5
;5 6
public 
DateTime 
Date 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
DateTime- 5
.5 6
Now6 9
;9 :
} 
} ç
hC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Models\AthleteDbContext.cs
	namespace 	

AthleteAPI
 
. 
Models 
{ 
public		 

class		 
AthleteDbContext		 !
:		" #
	DbContext		$ -
{

 
public 
AthleteDbContext 
(  
DbContextOptions  0
options1 8
)8 9
:: ;
base< @
(@ A
optionsA H
)H I
{ 	
Database 
. 
EnsureCreated "
(" #
)# $
;$ %
} 	
public 
DbSet 
< 
Athlete 
> 
Athletes &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} ∞

XC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Program.cs
	namespace

 	

AthleteAPI


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} Ü0
mC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Repository\AthleteRepository.cs
	namespace 	

AthleteAPI
 
. 

Repository 
{ 
public		 

class		 
AthleteRepository		 "
:		# $
IAthleteRepository		% 7
{

 
private 
readonly 
AthleteDbContext )
	dbContext* 3
;3 4
public 
AthleteRepository  
(  !
AthleteDbContext! 1

_dbContext2 <
)< =
{ 	
	dbContext 
= 

_dbContext "
;" #
} 	
public 
int 

AddAthlete 
( 
Athlete %
athlete& -
)- .
{ 	
var 

topAthlete 
= 
	dbContext &
.& '
Athletes' /
./ 0
OrderByDescending0 A
(A B
xB C
=>D F
xG H
.H I
	AthleteIdI R
)R S
.S T
FirstOrDefaultT b
(b c
)c d
;d e
if 
( 

topAthlete 
== 
null "
)" #
{ 
athlete 
. 
	AthleteId !
=" #
$num$ (
;( )
} 
else 
{ 
athlete 
. 
	AthleteId !
=" #

topAthlete$ .
.. /
	AthleteId/ 8
+9 :
$num; <
;< =
} 
	dbContext 
. 
Athletes 
. 
Add "
(" #
athlete# *
)* +
;+ ,
return 
	dbContext 
. 
SaveChanges (
(( )
)) *
;* +
} 	
public 
int 
BlockAthleteById #
(# $
int$ '
id( *
,* +
string, 2
status3 9
)9 :
{   	
var!! 
athlete!! 
=!! 
GetAthleteById!! (
(!!( )
id!!) +
)!!+ ,
;!!, -
athlete"" 
."" 
Status"" 
="" 
status"" #
;""# $
	dbContext## 
.## 
Entry## 
<## 
Athlete## #
>### $
(##$ %
athlete##% ,
)##, -
.##- .
State##. 3
=##4 5
	Microsoft##6 ?
.##? @
EntityFrameworkCore##@ S
.##S T
EntityState##T _
.##_ `
Modified##` h
;##h i
return$$ 
	dbContext$$ 
.$$ 
SaveChanges$$ (
($$( )
)$$) *
;$$* +
}%% 	
public'' 
List'' 
<'' 
Athlete'' 
>'' 
GetAllAthletes'' +
(''+ ,
)'', -
{(( 	
return)) 
	dbContext)) 
.)) 
Athletes)) %
.))% &
ToList))& ,
()), -
)))- .
;)). /
}** 	
public,, 
List,, 
<,, 
Athlete,, 
>,, 
GetAllAthletes,, +
(,,+ ,
int,,, /
id,,0 2
),,2 3
{-- 	
return.. 
	dbContext.. 
... 
Athletes.. %
...% &
Where..& +
(..+ ,
x.., -
=>..- /
x../ 0
...0 1
	AthleteId..1 :
!=..; =
id..> @
)..@ A
...A B
ToList..B H
(..H I
)..I J
;..J K
}// 	
public11 
List11 
<11 
string11 
>11 
GetAllCategories11 ,
(11, -
)11- .
{22 	
return33 
	dbContext33 
.33 
Athletes33 %
.33% &
Select33& ,
(33, -
x33- .
=>33/ 1
x332 3
.333 4
Category334 <
)33< =
.33= >
Distinct33> F
(33F G
)33G H
.33H I
ToList33I O
(33O P
)33P Q
;33Q R
}44 	
public66 
List66 
<66 
Athlete66 
>66  
GetAthleteByCategory66 1
(661 2
string662 8
category669 A
)66A B
{77 	
return88 
	dbContext88 
.88 
Athletes88 %
.88% &
Where88& +
(88+ ,
x88, -
=>88. 0
x881 2
.882 3
Category883 ;
.88; <
Equals88< B
(88B C
category88C K
)88K L
)88L M
.88M N
ToList88N T
(88T U
)88U V
;88V W
}99 	
public;; 
Athlete;; 
GetAthleteById;; %
(;;% &
int;;& )
id;;* ,
);;, -
{<< 	
return== 
	dbContext== 
.== 
Athletes== %
.==% &
Where==& +
(==+ ,
x==, -
=>==. 0
x==1 2
.==2 3
	AthleteId==3 <
.==< =
Equals=== C
(==C D
id==D F
)==F G
)==G H
.==H I
FirstOrDefault==I W
(==W X
)==X Y
;==Y Z
}>> 	
public@@ 
Athlete@@ 
GetAthleteByName@@ '
(@@' (
string@@( .
name@@/ 3
)@@3 4
{AA 	
returnBB 
	dbContextBB 
.BB 
AthletesBB %
.BB% &
WhereBB& +
(BB+ ,
xBB, -
=>BB. 0
xBB1 2
.BB2 3
NameBB3 7
.BB7 8
EqualsBB8 >
(BB> ?
nameBB? C
)BBC D
)BBD E
.BBE F
FirstOrDefaultBBF T
(BBT U
)BBU V
;BBV W
}CC 	
}DD 
}EE ä
nC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Repository\IAthleteRepository.cs
	namespace 	

AthleteAPI
 
. 

Repository 
{ 
public 

	interface 
IAthleteRepository '
{ 
List 
< 
Athlete 
> 
GetAllAthletes $
($ %
int% (
id) +
)+ ,
;, -
List		 
<		 
Athlete		 
>		 
GetAllAthletes		 $
(		$ %
)		% &
;		& '
List

 
<

 
string

 
>

 
GetAllCategories

 %
(

% &
)

& '
;

' (
Athlete 
GetAthleteById 
( 
int "
id# %
)% &
;& '
Athlete 
GetAthleteByName  
(  !
string! '
name( ,
), -
;- .
List 
< 
Athlete 
>  
GetAthleteByCategory *
(* +
string+ 1
category2 :
): ;
;; <
int 

AddAthlete 
( 
Athlete 
athlete &
)& '
;' (
int 
BlockAthleteById 
( 
int  
id! #
,# $
string% +
status, 2
)2 3
;3 4
} 
} ì&
iC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\ServiceRegistryExtension.cs
	namespace		 	

AthleteAPI		
 
{

 
public 

static 
class $
ServiceRegistryExtension 0
{ 
public 
static 
IServiceCollection (
AddConsulConfig) 8
(8 9
this9 =
IServiceCollection> P
servicesQ Y
,Y Z
IConfiguration[ i!
configurationSettingsj 
)	 Ä
{ 	
services 
. 
AddSingleton !
<! "
IConsulClient" /
,/ 0
ConsulClient1 =
>= >
(> ?
p? @
=>A C
newD G
ConsulClientH T
(T U
consulConfigU a
=>b d
{ 
consulConfig 
. 
Address $
=% &
new' *
Uri+ .
(. /
Environment/ :
.: ;"
GetEnvironmentVariable; Q
(Q R
$strR a
)a b
)b c
;c d
} 
) 
) 
; 
return 
services 
; 
} 	
public 
static 
IApplicationBuilder )
	UseConsul* 3
(3 4
this4 8
IApplicationBuilder9 L
appM P
,P Q
IConfigurationR `!
configirationSettingsa v
)v w
{ 	
var 
consulClient 
= 
app "
." #
ApplicationServices# 6
.6 7
GetRequiredService7 I
<I J
IConsulClientJ W
>W X
(X Y
)Y Z
;Z [
var 
logger 
= 
app 
. 
ApplicationServices 0
.0 1
GetRequiredService1 C
<C D
ILoggerFactoryD R
>R S
(S T
)T U
.U V
CreateLoggerV b
(b c
$strc q
)q r
;r s
var 
lifetime 
= 
app 
. 
ApplicationServices 2
.2 3
GetRequiredService3 E
<E F$
IHostApplicationLifetimeF ^
>^ _
(_ `
)` a
;a b
var 
registration 
= 
new "$
AgentServiceRegistration# ;
(; <
)< =
{ 
ID## 
=## 
Environment##  
.##  !"
GetEnvironmentVariable##! 7
(##7 8
$str##8 K
)##K L
,##L M
Name$$ 
=$$ 
Environment$$ "
.$$" #"
GetEnvironmentVariable$$# 9
($$9 :
$str$$: M
)$$M N
,$$N O
Address%% 
=%% 
Environment%% %
.%%% &"
GetEnvironmentVariable%%& <
(%%< =
$str%%= P
)%%P Q
,%%Q R
Port&& 
=&& 
int&& 
.&& 
Parse&&  
(&&  !
Environment&&! ,
.&&, -"
GetEnvironmentVariable&&- C
(&&C D
$str&&D W
)&&W X
)&&X Y
}(( 
;(( 
logger** 
.** 
LogInformation** !
(**! "
$str**" ;
)**; <
;**< =
consulClient++ 
.++ 
Agent++ 
.++ 
ServiceDeregister++ 0
(++0 1
registration++1 =
.++= >
ID++> @
)++@ A
.++A B
ConfigureAwait++B P
(++P Q
true++Q U
)++U V
;++V W
consulClient,, 
.,, 
Agent,, 
.,, 
ServiceRegister,, .
(,,. /
registration,,/ ;
),,; <
.,,< =
ConfigureAwait,,= K
(,,K L
true,,L P
),,P Q
;,,Q R
lifetime.. 
... 
ApplicationStopped.. '
...' (
Register..( 0
(..0 1
(..1 2
)..2 3
=>..4 6
{// 
logger00 
.00 
LogInformation00 %
(00% &
$str00& G
)00G H
;00H I
consulClient11 
.11 
Agent11 "
.11" #
ServiceDeregister11# 4
(114 5
registration115 A
.11A B
ID11B D
)11D E
.11E F
ConfigureAwait11F T
(11T U
true11U Y
)11Y Z
;11Z [
}22 
)22 
;22 
return44 
app44 
;44 
}55 	
}66 
}77 à3
gC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Service\AthleteService.cs
	namespace		 	

AthleteAPI		
 
.		 
Service		 
{

 
public 

class 
AthleteService 
:  !
IAthleteService" 1
{ 
private 
readonly 
IAthleteRepository +
repo, 0
;0 1
public 
AthleteService 
( 
IAthleteRepository 0
_repo1 6
)6 7
{ 	
repo 
= 
_repo 
; 
} 	
public 
int 

AddAthlete 
( 
Athlete %
athlete& -
)- .
{ 	
var 
ath 
= 
repo 
.  
GetAthleteByCategory /
(/ 0
athlete0 7
.7 8
Category8 @
)@ A
;A B
if 
( 
ath 
!= 
null 
) 
{ 
var 
ath1 
= 
ath 
. 
Where $
($ %
x% &
=>' )
x* +
.+ ,
Name, 0
.0 1
Equals1 7
(7 8
athlete8 ?
.? @
Name@ D
)D E
)E F
.F G
FirstOrDefaultG U
(U V
)V W
;W X
if 
( 
ath1 
!= 
null  
)  !
throw 
new )
AthleteAlreadyExistsException ;
(; <
$"< >
$str> O
{O P
athleteP W
.W X
	AthleteIdX a
}a b
$strb q
"q r
)r s
;s t
} 
return 
repo 
. 

AddAthlete "
(" #
athlete# *
)* +
;+ ,
} 	
public 
int 
BlockAthleteById #
(# $
int$ '
id( *
,* +
string, 2
status3 9
)9 :
{ 	
var   
ath   
=   
repo   
.   
GetAthleteById   )
(  ) *
id  * ,
)  , -
;  - .
if!! 
(!! 
ath!! 
==!! 
null!! 
)!! 
{"" 
throw## 
new## $
AthleteNotFoundException## 6
(##6 7
$"##7 9
$str##9 J
{##J K
id##K M
}##M N
$str##N ^
"##^ _
)##_ `
;##` a
}$$ 
return%% 
repo%% 
.%% 
BlockAthleteById%% (
(%%( )
id%%) +
,%%+ ,
status%%, 2
)%%2 3
;%%3 4
}&& 	
public(( 
List(( 
<(( 
Athlete(( 
>(( 
GetAllAthletes(( +
(((+ ,
int((, /
id((0 2
)((2 3
{)) 	
return** 
repo** 
.** 
GetAllAthletes** &
(**& '
id**' )
)**) *
;*** +
}++ 	
public-- 
List-- 
<-- 
Athlete-- 
>-- 
GetAllAthletes-- +
(--+ ,
)--, -
{.. 	
return// 
repo// 
.// 
GetAllAthletes// &
(//& '
)//' (
;//( )
}00 	
public22 
List22 
<22 
string22 
>22 
GetAllCategories22 ,
(22, -
)22- .
{33 	
return44 
repo44 
.44 
GetAllCategories44 (
(44( )
)44) *
;44* +
}55 	
public77 
List77 
<77 
Athlete77 
>77 #
GetAllUnblockedAthletes77 4
(774 5
)775 6
{88 	
var99 
ath99 
=99 
repo99 
.99 
GetAllAthletes99 )
(99) *
)99* +
;99+ ,
return:: 
ath:: 
.:: 
Where:: 
(:: 
x:: 
=>:: !
x::" #
.::# $
Status::$ *
!=::+ -
$str::. 7
)::7 8
.::8 9
ToList::9 ?
(::? @
)::@ A
;::A B
};; 	
public== 
List== 
<== 
Athlete== 
>==  
GetAthleteByCategory== 1
(==1 2
string==2 8
category==9 A
)==A B
{>> 	
return?? 
repo?? 
.??  
GetAthleteByCategory?? ,
(??, -
category??- 5
)??5 6
;??6 7
}@@ 	
publicBB 
AthleteBB 
GetAthleteByIdBB %
(BB% &
intBB& )
idBB* ,
)BB, -
{CC 	
varDD 
resDD 
=DD 
repoDD 
.DD 
GetAthleteByIdDD )
(DD) *
idDD* ,
)DD, -
;DD- .
ifEE 
(EE 
resEE 
==EE 
nullEE 
)EE 
{FF 
throwGG 
newGG $
AthleteNotFoundExceptionGG 2
(GG2 3
$"GG3 5
$strGG5 F
{GGF G
idGGG I
}GGI J
$strGGJ Z
"GGZ [
)GG[ \
;GG\ ]
}HH 
returnII 
resII 
;II 
}JJ 	
publicLL 
AthleteLL 
GetAthleteByNameLL '
(LL' (
stringLL( .
nameLL/ 3
)LL3 4
{MM 	
varNN 
resNN 
=NN 
repoNN 
.NN 
GetAthleteByNameNN +
(NN+ ,
nameNN, 0
)NN0 1
;NN1 2
ifOO 
(OO 
resOO 
==OO 
nullOO 
)OO 
{PP 
throwQQ 
newQQ $
AthleteNotFoundExceptionQQ 2
(QQ2 3
$"QQ3 5
$strQQ5 H
{QQH I
nameQQI M
}QQM N
$strQQN ^
"QQ^ _
)QQ_ `
;QQ` a
}RR 
returnSS 
resSS 
;SS 
}TT 	
}UU 
}VV ï
hC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Service\IAthleteService.cs
	namespace 	

AthleteAPI
 
. 
Service 
{ 
public		 

	interface		 
IAthleteService		 $
{

 
List 
< 
Athlete 
> 
GetAllAthletes $
($ %
int% (
id) +
)+ ,
;, -
List 
< 
Athlete 
> 
GetAllAthletes $
($ %
)% &
;& '
List 
< 
Athlete 
> #
GetAllUnblockedAthletes -
(- .
). /
;/ 0
List 
< 
string 
> 
GetAllCategories %
(% &
)& '
;' (
Athlete 
GetAthleteById 
( 
int "
id# %
)% &
;& '
Athlete 
GetAthleteByName  
(  !
string! '
name( ,
), -
;- .
List 
< 
Athlete 
>  
GetAthleteByCategory *
(* +
string+ 1
category2 :
): ;
;; <
int 

AddAthlete 
( 
Athlete 
athlete &
)& '
;' (
int 
BlockAthleteById 
( 
int  
id! #
,# $
string% +
status, 2
)2 3
;3 4
} 
} ¢/
XC:\Users\amazi\OneDrive\Documents\Personal\SBA\athlete-app-backend\AthleteAPI\Startup.cs
	namespace 	

AthleteAPI
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public!! 
void!! 
ConfigureServices!! %
(!!% &
IServiceCollection!!& 8
services!!9 A
)!!A B
{"" 	
services## 
.## 
AddConsulConfig## $
(##$ %
Configuration##% 2
)##2 3
;##3 4
services$$ 
.$$ 
AddControllers$$ #
($$# $
)$$$ %
.$$% &
AddNewtonsoftJson$$& 7
($$7 8
)$$8 9
;$$9 :
services(( 
.(( 
AddDbContext(( !
<((! "
AthleteDbContext((" 2
>((2 3
(((3 4
options((4 ;
=>((< >
options((? F
.((F G
UseSqlServer((G S
(((S T
Environment((T _
.((_ `"
GetEnvironmentVariable((` v
(((v w
$str	((w á
)
((á à
)
((à â
)
((â ä
;
((ä ã
services)) 
.)) 
	AddScoped)) 
<)) 
IAthleteRepository)) 1
,))1 2
AthleteRepository))3 D
>))D E
())E F
)))F G
;))G H
services** 
.** 
	AddScoped** 
<** 
IAthleteService** .
,**. /
AthleteService**0 >
>**> ?
(**? @
)**@ A
;**A B
var-- 
key-- 
=-- 
new--  
SymmetricSecurityKey-- .
(--. /
Encoding--/ 7
.--7 8
UTF8--8 <
.--< =
GetBytes--= E
(--E F
$str--F c
)--c d
)--d e
;--e f
services.. 
... 
AddAuthentication.. &
(..& '
options..' .
=>../ 1
{// 
options00 
.00 %
DefaultAuthenticateScheme00 1
=002 3
JwtBearerDefaults004 E
.00E F 
AuthenticationScheme00F Z
;00Z [
options11 
.11 "
DefaultChallengeScheme11 .
=11/ 0
JwtBearerDefaults111 B
.11B C 
AuthenticationScheme11C W
;11W X
}22 
)22 
.22 
AddJwtBearer22 
(22 
o22 
=>22  
o22! "
.22" #%
TokenValidationParameters22# <
=22= >
new22? B%
TokenValidationParameters22C \
(22\ ]
)22] ^
{33 $
ValidateIssuerSigningKey44 (
=44) *
true44+ /
,44/ 0
IssuerSigningKey55  
=55! "
key55# &
,55& '
ValidateIssuer77 
=77  
true77! %
,77% &
ValidIssuer88 
=88 
$str88 '
,88' (
ValidateAudience::  
=::! "
true::# '
,::' (
ValidAudience;; 
=;; 
$str;;  ,
}<< 
)<< 
;<< 
services?? 
.?? 
AddCors?? 
(?? 
options?? $
=>??% '
options??( /
.??/ 0
	AddPolicy??0 9
(??9 :
$str??: J
,??J K
policy??L R
=>??S U
policy??V \
.??\ ]
AllowAnyOrigin??] k
(??k l
)??l m
.??m n
AllowAnyHeader??n |
(??| }
)??} ~
.??~ 
AllowAnyMethod	?? ç
(
??ç é
)
??é è
)
??è ê
)
??ê ë
;
??ë í
servicesBB 
.BB 
AddSwaggerGenBB "
(BB" #
)BB# $
;BB$ %
}CC 	
publicFF 
voidFF 
	ConfigureFF 
(FF 
IApplicationBuilderFF 1
appFF2 5
,FF5 6
IWebHostEnvironmentFF7 J
envFFK N
)FFN O
{GG 	
ifHH 
(HH 
envHH 
.HH 
IsDevelopmentHH !
(HH! "
)HH" #
)HH# $
{II 
appJJ 
.JJ %
UseDeveloperExceptionPageJJ -
(JJ- .
)JJ. /
;JJ/ 0
}KK 
appMM 
.MM 
UseHttpsRedirectionMM #
(MM# $
)MM$ %
;MM% &
appOO 
.OO 
	UseConsulOO 
(OO 
ConfigurationOO '
)OO' (
;OO( )
appQQ 
.QQ 
UseCorsQQ 
(QQ 
$strQQ (
)QQ( )
;QQ) *
appSS 
.SS 

UseSwaggerSS 
(SS 
)SS 
;SS 
appUU 
.UU 
UseSwaggerUIUU 
(UU 
optionsUU $
=>UU% '
optionsUU( /
.UU/ 0
SwaggerEndpointUU0 ?
(UU? @
$strUU@ Z
,UUZ [
$strUU\ k
)UUk l
)UUl m
;UUm n
appWW 
.WW 

UseRoutingWW 
(WW 
)WW 
;WW 
appYY 
.YY 
UseAuthenticationYY !
(YY! "
)YY" #
.YY# $
UseAuthorizationYY$ 4
(YY4 5
)YY5 6
;YY6 7
app[[ 
.[[ 
UseEndpoints[[ 
([[ 
	endpoints[[ &
=>[[' )
{\\ 
	endpoints]] 
.]] 
MapControllers]] (
(]]( )
)]]) *
;]]* +
}^^ 
)^^ 
;^^ 
}__ 	
}`` 
}aa 